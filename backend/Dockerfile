# ШАГ 1: Выбираем базовый образ
# Это как выбрать операционную систему для нашего приложения
# node:20-alpine = Node.js версии 20, но облегчённая версия (alpine = меньше размер)
FROM node:20-alpine

# ШАГ 2: Устанавливаем рабочую директорию внутри контейнера
# Это как сказать: "Все следующие команды выполняй в папке /app"
WORKDIR /app

# ШАГ 3: Копируем файлы зависимостей
# Сначала копируем только package.json и package-lock.json
# Зачем? Чтобы Docker мог закешировать установку зависимостей
# Если код изменится, но зависимости нет - Docker не будет переустанавливать их заново
COPY package*.json ./

# ШАГ 4: Устанавливаем зависимости
# npm install установит все библиотеки из package.json
RUN npm install

# ШАГ 5: Копируем весь остальной код
# Теперь копируем все файлы проекта (кроме тех, что в .dockerignore)
COPY . .

# ШАГ 6: Открываем порт
# Говорим Docker: "Этот контейнер будет слушать на порту 5000"
# Но это не значит, что порт автоматически откроется - это просто информация
EXPOSE 5000

# ШАГ 7: Команда запуска
# Когда контейнер запустится, выполнится эта команда
# node index.js - запустит наш сервер
CMD ["node", "index.js"]


